<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Complaint Center</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:ital,wght@0,300;0,400;0,500;1,300&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f14;
    --bg2: #13161d;
    --bg3: #1a1e28;
    --card: #1e2330;
    --border: rgba(255,255,255,0.07);
    --accent: #5b6af5;
    --accent2: #e05c8a;
    --accent3: #27c98f;
    --text: #e8eaf0;
    --text2: #8b92a8;
    --text3: #5a6075;
    --glow: 0 0 40px rgba(91,106,245,0.15);
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: var(--bg); color: var(--text); font-family: 'DM Sans', sans-serif; min-height: 100vh; overflow-x: hidden; }
  h1, h2, h3, h4 { font-family: 'Syne', sans-serif; }

  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");
    pointer-events: none; z-index: 1000; opacity: .4;
  }

  .page { display: none; min-height: 100vh; flex-direction: column; }
  .page.active { display: flex; }

  /* LANDING */
  #landing {
    background: radial-gradient(ellipse 80% 60% at 60% -10%, rgba(91,106,245,0.18) 0%, transparent 60%),
                radial-gradient(ellipse 50% 40% at 10% 80%, rgba(224,92,138,0.1) 0%, transparent 50%),
                var(--bg);
    align-items: center; justify-content: center; text-align: center; padding: 2rem;
  }

  .logo-badge {
    display: inline-flex; align-items: center; gap: .5rem;
    background: var(--card); border: 1px solid var(--border);
    padding: .4rem 1rem; border-radius: 100px;
    font-size: .75rem; font-weight: 500; color: var(--accent);
    letter-spacing: .08em; text-transform: uppercase; margin-bottom: 2.5rem;
  }
  .logo-badge span { width: 6px; height: 6px; background: var(--accent); border-radius: 50%; animation: pulse 2s infinite; display:inline-block; }
  @keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:.5;transform:scale(1.3)} }

  .landing-title {
    font-size: clamp(2.4rem, 7vw, 5rem); font-weight: 800; line-height: 1.05;
    background: linear-gradient(135deg, #fff 30%, var(--accent) 70%, var(--accent2));
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    margin-bottom: 1.2rem;
  }
  .landing-sub { font-size: 1.1rem; color: var(--text2); max-width: 500px; margin: 0 auto 3rem; line-height: 1.7; }

  .btn-group { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }

  .btn {
    display: inline-flex; align-items: center; gap: .5rem;
    padding: .75rem 1.8rem; border-radius: 10px; border: none;
    font-family: 'Syne', sans-serif; font-weight: 600; font-size: .95rem;
    cursor: pointer; transition: all .2s; text-decoration: none;
  }
  .btn-primary { background: var(--accent); color: #fff; box-shadow: 0 4px 24px rgba(91,106,245,0.4); }
  .btn-primary:hover { background: #6e7df7; transform: translateY(-2px); box-shadow: 0 8px 32px rgba(91,106,245,0.5); }
  .btn-outline { background: transparent; color: var(--text); border: 1px solid var(--border); }
  .btn-outline:hover { background: var(--card); transform: translateY(-2px); }
  .btn-ghost { background: transparent; color: var(--text2); border: none; font-size: .9rem; cursor: pointer; font-family: 'DM Sans'; }
  .btn-ghost:hover { color: var(--text); }
  .btn-sm { padding: .45rem 1rem; font-size: .85rem; }

  /* MODAL */
  .modal-overlay {
    display: none; position: fixed; inset: 0;
    background: rgba(0,0,0,.7); backdrop-filter: blur(8px);
    z-index: 500; align-items: center; justify-content: center; padding: 1rem;
  }
  .modal-overlay.open { display: flex; }
  .modal {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 20px; padding: 2.5rem; width: 100%; max-width: 420px;
    box-shadow: var(--glow), 0 40px 80px rgba(0,0,0,.5);
    animation: slideUp .3s ease;
  }
  @keyframes slideUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }
  .modal-title { font-size: 1.5rem; font-weight: 700; margin-bottom: .4rem; }
  .modal-sub { font-size: .9rem; color: var(--text2); margin-bottom: 2rem; }

  .role-tabs { display: flex; background: var(--bg2); border-radius: 10px; padding: .3rem; margin-bottom: 1.8rem; gap: .3rem; }
  .role-tab {
    flex: 1; padding: .55rem; text-align: center; border-radius: 8px;
    font-family: 'Syne'; font-weight: 600; font-size: .88rem;
    cursor: pointer; transition: all .2s; color: var(--text2); border: none; background: none;
  }
  .role-tab.active { background: var(--accent); color: #fff; }

  .form-group { margin-bottom: 1.2rem; }
  .form-label { display: block; font-size: .83rem; font-weight: 500; color: var(--text2); margin-bottom: .5rem; letter-spacing: .03em; }
  .form-input, .form-select, .form-textarea {
    width: 100%; background: var(--bg2); border: 1px solid var(--border);
    border-radius: 10px; padding: .75rem 1rem; color: var(--text);
    font-family: 'DM Sans'; font-size: .95rem; transition: border-color .2s, box-shadow .2s; outline: none;
  }
  .form-input:focus, .form-select:focus, .form-textarea:focus {
    border-color: var(--accent); box-shadow: 0 0 0 3px rgba(91,106,245,0.15);
  }
  .form-textarea { resize: vertical; min-height: 110px; }
  .form-input.error { border-color: var(--accent2); }

  /* NAV */
  nav {
    display: flex; align-items: center; justify-content: space-between;
    padding: 1rem 2rem; border-bottom: 1px solid var(--border);
    background: rgba(13,15,20,.9); backdrop-filter: blur(12px);
    position: sticky; top: 0; z-index: 100;
  }
  .nav-brand { font-family: 'Syne'; font-weight: 800; font-size: 1.1rem; display: flex; align-items: center; gap: .6rem; }
  .nav-brand .dot { width: 8px; height: 8px; border-radius: 50%; background: var(--accent); }
  .nav-user { display: flex; align-items: center; gap: 1rem; flex-wrap: wrap; }
  .nav-avatar {
    width: 36px; height: 36px; border-radius: 50%;
    background: linear-gradient(135deg, var(--accent), var(--accent2));
    display: flex; align-items: center; justify-content: center;
    font-family: 'Syne'; font-weight: 700; font-size: .85rem; color: #fff; flex-shrink:0;
  }

  /* LAYOUT */
  .dashboard-layout { display: grid; grid-template-columns: 240px 1fr; flex: 1; }
  @media(max-width:768px) { .dashboard-layout { grid-template-columns: 1fr; } }

  .sidebar { background: var(--bg2); border-right: 1px solid var(--border); padding: 1.5rem 1rem; }
  @media(max-width:768px) { .sidebar { display: none; } }

  .sidebar-label { font-size: .72rem; font-weight: 600; color: var(--text3); letter-spacing: .1em; text-transform: uppercase; padding: 0 .5rem; margin-bottom: .6rem; }

  .nav-item {
    display: flex; align-items: center; gap: .7rem;
    padding: .65rem .75rem; border-radius: 10px;
    color: var(--text2); font-size: .9rem; font-weight: 500;
    cursor: pointer; transition: all .15s; border: none; background: none; width: 100%; text-align: left;
    margin-bottom: .2rem;
  }
  .nav-item:hover { background: var(--card); color: var(--text); }
  .nav-item.active { background: rgba(91,106,245,.15); color: var(--accent); }
  .nav-item svg { width: 16px; height: 16px; flex-shrink: 0; }

  .content { padding: 2rem; overflow-y: auto; }

  /* STATS */
  .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 2rem; }
  .stat-card {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 14px; padding: 1.3rem; transition: transform .2s;
  }
  .stat-card:hover { transform: translateY(-2px); }
  .stat-icon { font-size: 1.4rem; margin-bottom: .8rem; }
  .stat-value { font-family: 'Syne'; font-weight: 800; font-size: 2rem; line-height: 1; margin-bottom: .3rem; }
  .stat-label { font-size: .8rem; color: var(--text2); }

  .section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1.5rem; flex-wrap: wrap; gap: 1rem; }
  .section-title { font-size: 1.3rem; font-weight: 700; }

  /* FORM */
  .form-card { background: var(--card); border: 1px solid var(--border); border-radius: 18px; padding: 2rem; max-width: 640px; }

  .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(110px, 1fr)); gap: .7rem; margin-bottom: 1.5rem; }
  .cat-btn {
    padding: .7rem .5rem; border-radius: 10px; border: 1px solid var(--border);
    background: var(--bg2); color: var(--text2); font-family: 'DM Sans'; font-size: .85rem;
    cursor: pointer; text-align: center; transition: all .15s;
    display: flex; flex-direction: column; align-items: center; gap: .4rem;
  }
  .cat-btn:hover { border-color: var(--accent); color: var(--text); background: rgba(91,106,245,.05); }
  .cat-btn.selected { border-color: var(--accent); background: rgba(91,106,245,.12); color: var(--accent); }
  .cat-btn .cat-icon { font-size: 1.4rem; }

  /* COMPLAINTS */
  .complaints-list { display: flex; flex-direction: column; gap: 1rem; }
  .complaint-card {
    background: var(--card); border: 1px solid var(--border);
    border-radius: 14px; padding: 1.4rem;
    transition: border-color .2s, transform .2s; animation: fadeIn .3s ease;
  }
  @keyframes fadeIn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
  .complaint-card:hover { border-color: rgba(91,106,245,.3); transform: translateY(-1px); }
  .complaint-header { display: flex; align-items: flex-start; justify-content: space-between; gap: 1rem; margin-bottom: .8rem; flex-wrap:wrap; }
  .complaint-meta { display: flex; align-items: center; gap: .6rem; flex-wrap: wrap; }

  .badge {
    display: inline-flex; align-items: center; gap: .3rem;
    padding: .3rem .7rem; border-radius: 100px; font-size: .75rem; font-weight: 500;
  }
  .badge-faculty   { background: rgba(91,106,245,.15); color: #7a88f8; }
  .badge-exam      { background: rgba(255,200,60,.1);  color: #f5c842; }
  .badge-transport { background: rgba(39,201,143,.1);  color: #27c98f; }
  .badge-class     { background: rgba(224,92,138,.1);  color: #e05c8a; }
  .badge-other     { background: rgba(255,255,255,.07);color: var(--text2); }

  .complaint-author { font-size: .82rem; color: var(--text2); }
  .complaint-time   { font-size: .78rem; color: var(--text3); white-space: nowrap; }
  .complaint-body   { font-size: .93rem; color: var(--text2); line-height: 1.7; }

  /* TOAST */
  .toast {
    position: fixed; bottom: 2rem; right: 2rem;
    padding: .8rem 1.4rem; border-radius: 10px;
    font-weight: 600; font-size: .9rem; z-index: 9999;
    transform: translateY(100px); opacity: 0; transition: all .3s; pointer-events: none;
    color: #0d0f14;
  }
  .toast.show { transform: translateY(0); opacity: 1; }

  /* EMPTY */
  .empty { text-align: center; padding: 4rem 2rem; color: var(--text2); }
  .empty-icon { font-size: 3rem; margin-bottom: 1rem; opacity: .4; }
  .empty h3 { font-size: 1.1rem; margin-bottom: .4rem; color: var(--text2); }
  .empty p  { font-size: .85rem; }

  /* FILTERS */
  .filter-bar { display: flex; gap: .5rem; flex-wrap: wrap; margin-bottom: 1.5rem; }
  .filter-chip {
    padding: .4rem .9rem; border-radius: 100px; font-size: .82rem;
    border: 1px solid var(--border); background: transparent;
    color: var(--text2); cursor: pointer; transition: all .15s; font-family: 'DM Sans';
  }
  .filter-chip:hover { border-color: var(--accent); color: var(--text); }
  .filter-chip.active { background: var(--accent); border-color: var(--accent); color: #fff; }

  .teacher-notice {
    background: rgba(91,106,245,.08); border: 1px solid rgba(91,106,245,.2);
    border-radius: 12px; padding: 1rem 1.3rem;
    font-size: .88rem; color: var(--text2); margin-bottom: 1.5rem;
    display: flex; gap: .7rem; align-items: center;
  }

  /* MOBILE NAV */
  .mobile-nav {
    display: none; gap: .3rem; padding: .8rem 1rem;
    background: var(--bg2); border-bottom: 1px solid var(--border); overflow-x: auto;
  }
  @media(max-width:768px) { .mobile-nav { display: flex; } }
  .mobile-nav-btn {
    white-space: nowrap; padding: .45rem .9rem; border-radius: 8px;
    border: 1px solid var(--border); background: none; color: var(--text2);
    font-family: 'DM Sans'; font-size: .82rem; cursor: pointer; transition: all .15s;
  }
  .mobile-nav-btn.active { background: rgba(91,106,245,.15); color: var(--accent); border-color: transparent; }

  @media(max-width:480px) {
    nav { padding: .8rem 1rem; }
    .content { padding: 1.2rem; }
    .nav-user span:not(.nav-avatar):not([style*="badge"]) { display:none; }
  }
</style>
</head>
<body>

<!-- LANDING -->
<div id="landing" class="page active">
  <div style="display:flex;align-items:center;justify-content:center;flex-direction:column;text-align:center;padding:3rem 1.5rem;flex:1">
    <div class="logo-badge"><span></span> University Portal</div>
    <h1 class="landing-title">Student Complaint<br>Center</h1>
    <p class="landing-sub">A transparent, secure platform for students to raise concerns and for faculty to respond ‚Äî making campus life better together.</p>
    <div class="btn-group">
      <button class="btn btn-primary" onclick="openAuth('student')">üéì I'm a Student</button>
      <button class="btn btn-outline" onclick="openAuth('teacher')">üë©‚Äçüè´ I'm a Teacher</button>
    </div>
    <p style="margin-top:3rem;font-size:.8rem;color:var(--text3)">Your email is always kept private ‚Äî only your name is publicly displayed.</p>
  </div>
</div>

<!-- STUDENT DASHBOARD -->
<div id="studentDash" class="page">
  <nav>
    <div class="nav-brand"><div class="dot"></div>Complaint Center</div>
    <div class="nav-user">
      <div class="nav-avatar" id="studentAvatar">S</div>
      <span id="studentNavName" style="font-size:.9rem;font-weight:500"></span>
      <button class="btn btn-ghost btn-sm" onclick="logout()">Sign out</button>
    </div>
  </nav>
  <div class="mobile-nav">
    <button class="mobile-nav-btn active" onclick="showPanel('s','overview',this)">Overview</button>
    <button class="mobile-nav-btn" onclick="showPanel('s','submit',this)">Submit</button>
    <button class="mobile-nav-btn" onclick="showPanel('s','mycomplaints',this)">My Complaints</button>
    <button class="mobile-nav-btn" onclick="showPanel('s','allcomplaints',this)">All</button>
  </div>
  <div class="dashboard-layout" style="flex:1">
    <aside class="sidebar">
      <div style="margin-bottom:2rem">
        <div class="sidebar-label">Menu</div>
        <button class="nav-item active" id="snav-overview" onclick="showPanel('s','overview',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
          Overview
        </button>
        <button class="nav-item" id="snav-submit" onclick="showPanel('s','submit',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
          Submit Complaint
        </button>
        <button class="nav-item" id="snav-mycomplaints" onclick="showPanel('s','mycomplaints',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/></svg>
          My Complaints
        </button>
        <button class="nav-item" id="snav-allcomplaints" onclick="showPanel('s','allcomplaints',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/></svg>
          All Complaints
        </button>
      </div>
    </aside>
    <main class="content">
      <!-- Overview -->
      <div id="s-panel-overview">
        <h2 style="font-size:1.5rem;margin-bottom:.4rem">Good day! üëã</h2>
        <p id="studentWelcome" style="color:var(--text2);margin-bottom:2rem;font-size:.95rem"></p>
        <div class="stats-grid">
          <div class="stat-card"><div class="stat-icon">üìù</div><div class="stat-value" id="ss-mine" style="color:var(--accent)">0</div><div class="stat-label">My Complaints</div></div>
          <div class="stat-card"><div class="stat-icon">üè´</div><div class="stat-value" id="ss-total" style="color:var(--accent2)">0</div><div class="stat-label">Total Submitted</div></div>
          <div class="stat-card"><div class="stat-icon">‚ö°</div><div class="stat-value" style="color:var(--accent3);font-size:1.1rem;padding-top:.5rem">Under Review</div><div class="stat-label">Status</div></div>
        </div>
        <div class="section-header" style="margin-top:2rem">
          <div class="section-title">Recent Complaints</div>
          <button class="btn btn-outline btn-sm" onclick="showPanel('s','submit',document.getElementById('snav-submit'))">+ New Complaint</button>
        </div>
        <div id="s-recent-list" class="complaints-list"></div>
      </div>

      <!-- Submit -->
      <div id="s-panel-submit" style="display:none">
        <div class="section-header"><div class="section-title">Submit a Complaint</div></div>
        <div class="form-card">
          <p style="font-size:.9rem;color:var(--text2);margin-bottom:1.5rem">Select a category and describe your issue. Your email will stay private.</p>
          <div class="form-group">
            <div class="form-label">Category *</div>
            <div class="category-grid">
              <button class="cat-btn" data-cat="Faculty" onclick="selectCat(this)"><span class="cat-icon">üë®‚Äçüè´</span>Faculty</button>
              <button class="cat-btn" data-cat="Exam" onclick="selectCat(this)"><span class="cat-icon">üìã</span>Exam</button>
              <button class="cat-btn" data-cat="Transport" onclick="selectCat(this)"><span class="cat-icon">üöå</span>Transport</button>
              <button class="cat-btn" data-cat="Class" onclick="selectCat(this)"><span class="cat-icon">üè´</span>Class</button>
              <button class="cat-btn" data-cat="Other" onclick="selectCat(this)"><span class="cat-icon">üí¨</span>Other</button>
            </div>
          </div>
          <div class="form-group">
            <label class="form-label" for="complaintMsg">Complaint Details *</label>
            <textarea class="form-textarea" id="complaintMsg" placeholder="Describe your issue in detail..."></textarea>
          </div>
          <button class="btn btn-primary" onclick="submitComplaint()" style="width:100%">Submit Complaint ‚Üí</button>
        </div>
      </div>

      <!-- My Complaints -->
      <div id="s-panel-mycomplaints" style="display:none">
        <div class="section-header"><div class="section-title">My Complaints</div></div>
        <div id="s-my-list" class="complaints-list"></div>
      </div>

      <!-- All Complaints -->
      <div id="s-panel-allcomplaints" style="display:none">
        <div class="section-header"><div class="section-title">All Complaints</div></div>
        <div class="filter-bar">
          <button class="filter-chip active" data-filter="All" onclick="filterC('s',this)">All</button>
          <button class="filter-chip" data-filter="Faculty" onclick="filterC('s',this)">Faculty</button>
          <button class="filter-chip" data-filter="Exam" onclick="filterC('s',this)">Exam</button>
          <button class="filter-chip" data-filter="Transport" onclick="filterC('s',this)">Transport</button>
          <button class="filter-chip" data-filter="Class" onclick="filterC('s',this)">Class</button>
          <button class="filter-chip" data-filter="Other" onclick="filterC('s',this)">Other</button>
        </div>
        <div id="s-all-list" class="complaints-list"></div>
      </div>
    </main>
  </div>
</div>

<!-- TEACHER DASHBOARD -->
<div id="teacherDash" class="page">
  <nav>
    <div class="nav-brand"><div class="dot"></div>Complaint Center</div>
    <div class="nav-user">
      <div class="nav-avatar" style="background:linear-gradient(135deg,var(--accent2),#8b5cf6)" id="teacherAvatar">T</div>
      <span id="teacherNavName" style="font-size:.9rem;font-weight:500"></span>
      <span style="font-size:.75rem;background:rgba(224,92,138,.15);color:var(--accent2);padding:.2rem .6rem;border-radius:100px;font-weight:600">Teacher</span>
      <button class="btn btn-ghost btn-sm" onclick="logout()">Sign out</button>
    </div>
  </nav>
  <div class="mobile-nav">
    <button class="mobile-nav-btn active" onclick="showPanel('t','overview',this)">Dashboard</button>
    <button class="mobile-nav-btn" onclick="showPanel('t','all',this)">All Complaints</button>
  </div>
  <div class="dashboard-layout" style="flex:1">
    <aside class="sidebar">
      <div style="margin-bottom:2rem">
        <div class="sidebar-label">Menu</div>
        <button class="nav-item active" id="tnav-overview" onclick="showPanel('t','overview',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/></svg>
          Dashboard
        </button>
        <button class="nav-item" id="tnav-all" onclick="showPanel('t','all',this)">
          <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/></svg>
          All Complaints
        </button>
      </div>
    </aside>
    <main class="content">
      <!-- Teacher Overview -->
      <div id="t-panel-overview">
        <h2 style="font-size:1.5rem;margin-bottom:.4rem">Teacher Dashboard</h2>
        <p id="teacherWelcome" style="color:var(--text2);margin-bottom:2rem;font-size:.95rem"></p>
        <div class="teacher-notice">üîí Student emails are hidden. Only names and complaint content are visible.</div>
        <div class="stats-grid">
          <div class="stat-card"><div class="stat-icon">üìã</div><div class="stat-value" id="ts-total" style="color:var(--accent)">0</div><div class="stat-label">Total Complaints</div></div>
          <div class="stat-card"><div class="stat-icon">üë®‚Äçüè´</div><div class="stat-value" id="ts-faculty" style="color:var(--accent2)">0</div><div class="stat-label">Faculty Issues</div></div>
          <div class="stat-card"><div class="stat-icon">üìã</div><div class="stat-value" id="ts-exam" style="color:#f5c842">0</div><div class="stat-label">Exam Issues</div></div>
          <div class="stat-card"><div class="stat-icon">üöå</div><div class="stat-value" id="ts-transport" style="color:var(--accent3)">0</div><div class="stat-label">Transport Issues</div></div>
          <div class="stat-card"><div class="stat-icon">üè´</div><div class="stat-value" id="ts-class" style="color:#a78bfa">0</div><div class="stat-label">Class Issues</div></div>
        </div>
        <div class="section-header" style="margin-top:2rem"><div class="section-title">Recent Complaints</div></div>
        <div id="t-recent-list" class="complaints-list"></div>
      </div>

      <!-- All (Teacher) -->
      <div id="t-panel-all" style="display:none">
        <div class="section-header"><div class="section-title">All Student Complaints</div></div>
        <div class="filter-bar">
          <button class="filter-chip active" data-filter="All" onclick="filterC('t',this)">All</button>
          <button class="filter-chip" data-filter="Faculty" onclick="filterC('t',this)">Faculty</button>
          <button class="filter-chip" data-filter="Exam" onclick="filterC('t',this)">Exam</button>
          <button class="filter-chip" data-filter="Transport" onclick="filterC('t',this)">Transport</button>
          <button class="filter-chip" data-filter="Class" onclick="filterC('t',this)">Class</button>
          <button class="filter-chip" data-filter="Other" onclick="filterC('t',this)">Other</button>
        </div>
        <div id="t-all-list" class="complaints-list"></div>
      </div>
    </main>
  </div>
</div>

<!-- AUTH MODAL -->
<div class="modal-overlay" id="authModal">
  <div class="modal">
    <div class="modal-title">Welcome üëã</div>
    <div class="modal-sub">Sign in to access the complaint center</div>
    <div class="role-tabs">
      <button class="role-tab active" id="tab-student" onclick="switchRole('student')">üéì Student</button>
      <button class="role-tab" id="tab-teacher" onclick="switchRole('teacher')">üë©‚Äçüè´ Teacher</button>
    </div>
    <div class="form-group">
      <label class="form-label">Full Name</label>
      <input type="text" class="form-input" id="authName" placeholder="Your full name">
    </div>
    <div class="form-group">
      <label class="form-label">Email Address</label>
      <input type="email" class="form-input" id="authEmail" placeholder="you@university.edu">
    </div>
    <button class="btn btn-primary" style="width:100%;margin-top:.5rem" onclick="doLogin()">Sign In ‚Üí</button>
    <button class="btn btn-ghost" style="width:100%;margin-top:.5rem" onclick="closeAuth()">Cancel</button>
  </div>
</div>

<div class="toast" id="toast"></div>

<script>
let complaints = JSON.parse(localStorage.getItem('scc_v2') || '[]');
let currentUser = null;
let currentRole = 'student';
let selectedCat = '';
let filters = { s: 'All', t: 'All' };

// AUTH
function openAuth(role) {
  currentRole = role;
  document.getElementById('tab-student').className = 'role-tab' + (role==='student'?' active':'');
  document.getElementById('tab-teacher').className = 'role-tab' + (role==='teacher'?' active':'');
  document.getElementById('authModal').classList.add('open');
  setTimeout(() => document.getElementById('authName').focus(), 100);
}
function closeAuth() { document.getElementById('authModal').classList.remove('open'); }
function switchRole(r) {
  currentRole = r;
  document.getElementById('tab-student').className = 'role-tab' + (r==='student'?' active':'');
  document.getElementById('tab-teacher').className = 'role-tab' + (r==='teacher'?' active':'');
}
function doLogin() {
  const name  = document.getElementById('authName').value.trim();
  const email = document.getElementById('authEmail').value.trim();
  if (!name)  { document.getElementById('authName').classList.add('error'); return; }
  if (!email || !email.includes('@')) { document.getElementById('authEmail').classList.add('error'); return; }
  currentUser = { name, email, role: currentRole };
  closeAuth();
  if (currentRole === 'student') {
    document.getElementById('studentAvatar').textContent = initials(name);
    document.getElementById('studentNavName').textContent = name;
    document.getElementById('studentWelcome').textContent = `Welcome back, ${name}! Here's your complaint summary.`;
    refreshStudentDash();
    showPage('studentDash');
    showPanel('s','overview', document.getElementById('snav-overview'));
  } else {
    document.getElementById('teacherAvatar').textContent = initials(name);
    document.getElementById('teacherNavName').textContent = name;
    document.getElementById('teacherWelcome').textContent = `Hello, ${name}. Review and manage all student complaints below.`;
    refreshTeacherDash();
    showPage('teacherDash');
    showPanel('t','overview', document.getElementById('tnav-overview'));
  }
}
function logout() { currentUser = null; selectedCat = ''; showPage('landing'); }

document.getElementById('authName').addEventListener('input', function(){ this.classList.remove('error'); });
document.getElementById('authEmail').addEventListener('input', function(){ this.classList.remove('error'); });
document.addEventListener('keydown', e => {
  if (e.key === 'Enter' && document.getElementById('authModal').classList.contains('open')) doLogin();
});

// ROUTING
function showPage(id) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function showPanel(role, panel, btn) {
  const prefix = role + '-panel-';
  document.querySelectorAll(`[id^="${prefix}"]`).forEach(p => p.style.display = 'none');
  const el = document.getElementById(`${prefix}${panel}`);
  if (el) el.style.display = '';
  if (btn) {
    const scope = btn.closest('.dashboard-layout, .mobile-nav');
    if (scope) scope.querySelectorAll('.nav-item, .mobile-nav-btn').forEach(n => n.classList.remove('active'));
    else document.querySelectorAll('.nav-item, .mobile-nav-btn').forEach(n => n.classList.remove('active'));
    btn.classList.add('active');
  }
  if (panel==='mycomplaints') renderList('s-my-list', complaints.filter(c=>c.email===currentUser.email));
  if (panel==='allcomplaints') renderFiltered('s');
  if (panel==='all') renderFiltered('t');
}

// CATEGORY
function selectCat(btn) {
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('selected'));
  btn.classList.add('selected');
  selectedCat = btn.dataset.cat;
}

// SUBMIT
function submitComplaint() {
  if (!selectedCat) { showToast('‚ö† Please select a category', '#e05c5c'); return; }
  const msg = document.getElementById('complaintMsg').value.trim();
  if (!msg) { showToast('‚ö† Please describe your complaint', '#e05c5c'); return; }
  complaints.unshift({
    id: Date.now(), name: currentUser.name, email: currentUser.email,
    category: selectedCat, message: msg,
    time: new Date().toLocaleString('en-GB', {day:'2-digit',month:'short',year:'numeric',hour:'2-digit',minute:'2-digit'})
  });
  localStorage.setItem('scc_v2', JSON.stringify(complaints));
  selectedCat = '';
  document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('selected'));
  document.getElementById('complaintMsg').value = '';
  showToast('‚úì Complaint submitted!');
  refreshStudentDash();
  showPanel('s','overview', document.getElementById('snav-overview'));
}

// RENDER
const badgeCls = c => ({'Faculty':'badge-faculty','Exam':'badge-exam','Transport':'badge-transport','Class':'badge-class','Other':'badge-other'}[c]||'badge-other');
const catEmoji = c => ({'Faculty':'üë®‚Äçüè´','Exam':'üìã','Transport':'üöå','Class':'üè´','Other':'üí¨'}[c]||'üí¨');

function renderList(id, list) {
  const el = document.getElementById(id);
  if (!el) return;
  if (!list.length) {
    el.innerHTML = `<div class="empty"><div class="empty-icon">üì≠</div><h3>Nothing here yet</h3><p>No complaints to show.</p></div>`;
    return;
  }
  el.innerHTML = list.map(c => `
    <div class="complaint-card">
      <div class="complaint-header">
        <div class="complaint-meta">
          <span class="badge ${badgeCls(c.category)}">${catEmoji(c.category)} ${c.category}</span>
          <span class="complaint-author">by ${esc(c.name)}</span>
        </div>
        <span class="complaint-time">${c.time}</span>
      </div>
      <div class="complaint-body">${esc(c.message)}</div>
    </div>`).join('');
}

function renderFiltered(role) {
  const f = filters[role];
  const list = f==='All' ? complaints : complaints.filter(c=>c.category===f);
  renderList(role==='s' ? 's-all-list' : 't-all-list', list);
}

function filterC(role, btn) {
  filters[role] = btn.dataset.filter;
  btn.closest('.filter-bar').querySelectorAll('.filter-chip').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderFiltered(role);
}

function refreshStudentDash() {
  const mine = complaints.filter(c=>c.email===currentUser.email);
  document.getElementById('ss-mine').textContent  = mine.length;
  document.getElementById('ss-total').textContent = complaints.length;
  renderList('s-recent-list', complaints.slice(0,5));
}

function refreshTeacherDash() {
  document.getElementById('ts-total').textContent    = complaints.length;
  document.getElementById('ts-faculty').textContent  = complaints.filter(c=>c.category==='Faculty').length;
  document.getElementById('ts-exam').textContent     = complaints.filter(c=>c.category==='Exam').length;
  document.getElementById('ts-transport').textContent= complaints.filter(c=>c.category==='Transport').length;
  document.getElementById('ts-class').textContent    = complaints.filter(c=>c.category==='Class').length;
  renderList('t-recent-list', complaints.slice(0,5));
}

// UTILS
function initials(n) { return n.split(' ').map(w=>w[0]).join('').toUpperCase().slice(0,2); }
function esc(s) { const d=document.createElement('div'); d.textContent=s; return d.innerHTML; }
function showToast(msg, bg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.background = bg || 'var(--accent3)';
  t.style.color = bg ? '#fff' : '#0d0f14';
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 3000);
}
</script>
</body>
</html>
